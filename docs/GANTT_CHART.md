# Діаграма Ганта для підподій

## Огляд

Система підтримує створення та відображення підподій для кожної події у вигляді інтерактивної діаграми Ганта. Діаграма дозволяє візуалізувати часові рамки підподій, їх залежності та прогрес виконання.

## Функціональність

### Основні можливості:
- **Візуалізація підподій** - відображення всіх підподій події на часовій шкалі
- **Кольорове кодування** - кожна підподія може мати власні кольори фону та тексту
- **Залежності** - підтримка залежностей між підподіями зі стрілками
- **Інтерактивність** - клік та подвійний клік для взаємодії з підподіями
- **Масштабування** - можливість збільшення/зменшення діаграми (50%-200%)
- **Режими перегляду** - день, тиждень, місяць
- **Адаптивність** - підтримка мобільних пристроїв

### Права доступу:
- **Перегляд діаграми**: всі користувачі з доступом до події
- **Створення підподій**: тільки наукові керівники події
- **Редагування підподій**: тільки наукові керівники події
- **Видалення підподій**: тільки наукові керівники події

## Технічна реалізація

### Компоненти:
1. **SubeventController** - обробка CRUD операцій та API для діаграми
2. **Subevent Model** - модель підподії з полями кольорів та залежностей
3. **Frappe Gantt** - JavaScript бібліотека для відображення діаграми
4. **Кастомні CSS стилі** - стилізація під дизайн системи

### API Endpoints:
- `GET /events/{event}/gantt-data` - отримання даних для діаграми
- `GET /teacher/events/{event}/subevents/create` - форма створення підподії
- `POST /teacher/events/{event}/subevents` - збереження нової підподії
- `GET /teacher/events/{event}/subevents/{subevent}/edit` - форма редагування
- `PUT /teacher/events/{event}/subevents/{subevent}` - оновлення підподії
- `DELETE /teacher/events/{event}/subevents/{subevent}` - видалення підподії

### Структура даних:
```json
{
  "id": "string",
  "name": "string", 
  "start": "YYYY-MM-DD",
  "end": "YYYY-MM-DD",
  "progress": 0,
  "dependencies": ["id1", "id2"],
  "custom_class": "string",
  "bg_color": "#RRGGBB",
  "fg_color": "#RRGGBB"
}
```

## Використання

### Створення підподії:
1. Перейти на сторінку деталей події
2. Натиснути кнопку "Додати підподію" (тільки для керівників)
3. Заповнити форму з назвою, датами, кольорами та залежностями
4. Зберегти підподію

### Управління діаграмою:
- **Зміна режиму перегляду**: кнопки "День", "Тиждень", "Місяць"
- **Масштабування**: кнопки "+" та "-" або кнопка "Скинути"
- **Редагування**: подвійний клік на підподію (тільки для керівників)
- **Інформація**: наведення курсору для показу popup з деталями

### Кольори:
- Кожна підподія може мати власний колір фону (`bg_color`)
- Колір тексту (`fg_color`) автоматично контрастує з фоном
- Кольори зберігаються в базі даних та застосовуються через CSS

## Валідація

### Обмеження дат:
- Дата початку підподії не може бути раніше дати початку події
- Дата завершення підподії не може бути пізніше дати завершення події
- Дата завершення не може бути раніше дати початку

### Залежності:
- Підподія не може залежати від самої себе
- Система перевіряє циклічні залежності
- Неможливо видалити підподію, від якої залежать інші

## Тестування

Система включає повний набір тестів:
- Тести CRUD операцій для підподій
- Тести API для діаграми Ганта
- Тести прав доступу
- Тести валідації даних

Запуск тестів:
```bash
php artisan test tests/Feature/SubeventTest.php
```
